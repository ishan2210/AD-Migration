# Import the Active Directory module if not already loaded
Import-Module ActiveDirectory

# Define the domain
$domain = "merittrac.net"  # Replace with the actual domain name

# Get all user accounts in the domain
$users = Get-AdUser -Filter {(ObjectClass -eq "user")} -SearchBase "DC=$domain,DC=com"

# Loop through each user and set the "Password never expires" option
foreach ($user in $users) {
    if (-not $user.PasswordNeverExpires) {
        Set-AdUser -Identity $user -PasswordNeverExpires $true
        Write-Host "Password for user '$($user.SamAccountName)' in domain '$domain' will never expire."
    } else {
        Write-Host "Password for user '$($user.SamAccountName)' in domain '$domain' is already set to never expire."
    }
}

Write-Host "Password never expires option has been set for all user accounts in domain '$domain'."
